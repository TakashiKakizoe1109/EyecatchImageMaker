!function(e,t){e.jscolor.presets.myPreset={format:"rgba",width:201,height:81,backgroundColor:"#333",palette:"#fff #000 #808080 #996e36 #f55525 #ffe438 #88dd20 #22e0cd #269aff #bb1cd4"};const a={isRecover:!1,e:{title:{},coverSize:{},backgroundColor:{},blurStrength:{},fontFamily:{},fontColor:{},fontSize:{},fontWeight:{},lineHeight:{},letterSpacing:{},textShadowStrength:{},textShadowLength:{},textShadowColor:{}},params:{title:{},coverSize:{},backgroundColor:{},blurStrength:{},fontFamily:{},fontColor:{},fontSize:{},fontWeight:{},lineHeight:{},letterSpacing:{},textShadowStrength:{},textShadowLength:{},textShadowColor:{}},event:{change:function(e){a.params[e.target.id.replace("js-","")]=e.target.value,a.func.updateStyle()},download:function(){e.html2canvas(e.document.querySelector("#js-image-wrapper")).then(function(e){let t=(new Date).getTime(),a=Math.floor(t/1e3),r=document.createElement("a");r.href=e.toDataURL("image/png"),r.download="eye-catch-"+a+".png",r.click()})}},func:{setChangeEvents:function(e){for(let t=0;t<e.length;++t)a.func.setChangeEvent(e[t])},setChangeEvent:function(t){a.e[t]=e.document.querySelector("#js-"+t),a.e[t].addEventListener("change",a.event.change);try{a.e[t].value?a.params[t]=a.e[t].value:a.e[t].innerText&&(a.params[t]=a.e[t].innerText)}catch(e){}},setHtmlFormValues:function(t){try{a.isRecover=!0,a.params=t,a.e.title.value=t.title,a.e.coverTitle.innerHTML=t.title,a.e.coverSize.value=t.coverSize,a.e.backgroundColor.value=t.backgroundColor,a.e.blurStrength.value=t.blurStrength,a.e.fontFamily.value=t.fontFamily,a.e.fontColor.value=t.fontColor,a.e.fontSize.value=t.fontSize,a.e.fontWeight.value=t.fontWeight,a.e.lineHeight.value=t.lineHeight,a.e.letterSpacing.value=t.letterSpacing,a.e.textShadowStrength.value=t.textShadowStrength,a.e.textShadowLength.value=t.textShadowLength,a.e.textShadowColor.value=t.textShadowColor,t.srcBase64&&e.document.querySelector("#js-image-wrapper img").setAttribute("src",t.srcBase64)}catch(e){console.error(e)}a.func.updateStyle()},updateStyle:function(){if(a.e.cover.style.background=a.params.backgroundColor,a.e.cover.style["backdrop-filter"]="blur("+a.params.blurStrength+"px)",a.e.cover.style["-webkit-backdrop-filter"]="blur("+a.params.blurStrength+"px)",a.e.cover.style.height=1*a.params.coverSize+"%",a.e.cover.style.top=(100-1*a.params.coverSize)/2+"%",a.e.coverTitle.innerHTML=a.params.title,a.e.coverTitle.style["font-family"]=a.params.fontFamily,a.e.coverTitle.style.color=a.params.fontColor,a.e.coverTitle.style["font-size"]=a.params.fontSize+"px",a.e.coverTitle.style["font-weight"]=a.params.fontWeight,a.e.coverTitle.style["line-height"]=a.params.lineHeight+"px",a.e.coverTitle.style["letter-spacing"]=a.params.letterSpacing+"px",a.params.textShadowStrength=1*a.params.textShadowStrength,a.params.textShadowStrength>0){let e=a.params.textShadowLength+" "+a.params.textShadowColor;for(let t=1;t<a.params.textShadowStrength;++t)e+=", "+a.params.textShadowLength+" "+a.params.textShadowColor;a.e.coverTitle.style["text-shadow"]=e}else a.e.coverTitle.style["text-shadow"]="none";e.localStorage.setItem("EyeCatchMakerData",JSON.stringify(a.params))},fileUpload:function(){let t=e.document.querySelector("#js-image-wrapper img");a.func.imageToBase64(t.getAttribute("src"),"image/png",function(t){!1===a.isRecover&&(e.document.querySelector("#js-image-wrapper img").setAttribute("src",t),a.params.srcBase64=t)});const r=e.document.querySelector("#js-image-wrapper");r.addEventListener("dragover",function(e){e.preventDefault(),r.classList.add("--dragover")}),r.addEventListener("dragleave",function(e){e.preventDefault(),r.classList.remove("--dragover")}),r.addEventListener("drop",function(o){try{o.preventDefault(),r.classList.remove("--dragover");const n=o.dataTransfer.files,l=new FileReader;l.onload=function(){t.setAttribute("src",l.result),a.params.srcBase64=l.result,e.localStorage.setItem("EyeCatchMakerData",JSON.stringify(a.params))},l.readAsDataURL(n[0])}catch(e){}})},imageToBase64:function(e,t,a){let r=document.createElement("canvas"),o=r.getContext("2d"),n=new Image;n.crossOrigin="Anonymous",n.onload=function(){r.height=n.height,r.width=n.width,o.drawImage(n,0,0);let e=r.toDataURL(t||"image/png");a.call(this,e),r=null},n.src=e}}};e.addEventListener("DOMContentLoaded",function(){t("#js-fontFamily").select2().on("select2:select",function(e){a.params.fontFamily=e.params.data.id,a.func.updateStyle()}),e.document.querySelector("#js-download").addEventListener("click",a.event.download),a.e.imageWrapper=e.document.querySelector("#js-image-wrapper"),a.e.cover=e.document.querySelector("#js-cover"),a.e.coverTitle=e.document.querySelector("#js-cover-title"),a.func.setChangeEvents(["title","coverSize","backgroundColor","blurStrength","fontFamily","fontColor","fontSize","fontWeight","lineHeight","letterSpacing","textShadowStrength","textShadowLength","textShadowColor"]);try{let t=e.localStorage.getItem("EyeCatchMakerData");if(null!==t&&void 0!==(t=JSON.parse(t)).title){e.confirm("Do you want to recover your data?")&&a.func.setHtmlFormValues(t)}}catch(e){console.error(e)}a.func.fileUpload()})}(window,jQuery);